
  <!DOCTYPE html>
  <html>
    <head>
      <title>sql-methods.ts</title>
      <link href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" type="text/css" rel="stylesheet">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/mode/javascript/javascript.min.js" type="text/javascript" charset="utf-8"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.css" type="text/css" rel="stylesheet">
<script src="..\..\..\..\assets\source-file.js" type="text/javascript" charset="utf-8"></script>
<link href="..\..\..\..\assets\source-file.css" type="text/css" rel="stylesheet">
    </head>
    <body>
    <div style="margin-top:3em" class="ui container"><h1 class="ui header"><a href="..\..\..\..\index.html">TypeScript coverage report</a></h1><table style="margin-top:2em" class="ui celled table"><thead class=""><tr class=""><th class="">Filename</th><th class="">Percent</th><th class="">Threshold</th><th class="">Total</th><th class="">Covered</th><th class="">Uncovered</th></tr></thead><tbody class=""><tr class="positive"><td class="">app\service\compute-rating\sql-methods.ts</td><td class="">100.00%</td><td class="">80%</td><td class="">48</td><td class="">48</td><td class="">0</td></tr></tbody></table><textarea id="editor" readonly="" style="margin-top:3em">import { sql } from &#x27;kysely&#x27;;
import { db } from &#x27;../../helpers/client.db&#x27;;
import { AvgSkill, Skills } from &#x27;skillcoop-types&#x27;;

export type UserEvaluationsBonus = {
  nb_mvp: number;
  nb_best_striker: number;
  user_own_evaluation: Skills | undefined;
  avg_evaluation_received: AvgSkill | undefined;
};

export class PlayerStatInsight {
  static async mvp(profileId: number) {
    const nbMvpResult = await sql&lt;{ nb_mvp: number }&gt;`
      SELECT 
        COUNT (*) AS nb_mvp
      FROM event  
      WHERE mvp_id = ${profileId}
      `.execute(db);
    return nbMvpResult.rows[0];
  }
  static async bestStriker(profileId: number) {
    const nbBestStrikerResult = await sql&lt;{ nb_best_striker: number }&gt;`
       SELECT 
        COUNT (*) AS nb_best_striker
      FROM event  
      WHERE best_striker_id = ${profileId}   
      `.execute(db);
    return nbBestStrikerResult.rows[0];
  }
  static async ownEvaluation(profileId: number) {
    const userOwnEvalResult = await sql&lt;Skills | undefined&gt;`
          SELECT
            pace,
            dribbling,
            defending,
            passing,
            shooting
          FROM skill_foot
          WHERE rater_id  = ${profileId}
          AND reviewee_id = ${profileId}
        `.execute(db);
    return { user_own_evaluation: userOwnEvalResult.rows[0] };
  }
  static async averageEvaluation(profileId: number) {
    const avgEvalsReceivedResult = await sql&lt;AvgSkill&gt;`
      SELECT
        COUNT (*) AS nb_eval_received,
        IFNULL(AVG(pace), 0) AS pace,
        IFNULL(AVG(dribbling), 0) AS dribbling,
        IFNULL(AVG(defending), 0) AS defending,
        IFNULL(AVG(passing), 0) AS passing,
        IFNULL(AVG(shooting), 0) AS shooting
      FROM skill_foot
      WHERE rater_id &lt;&gt;  ${profileId}
      AND reviewee_id =  ${profileId}
      GROUP BY reviewee_id
    `.execute(db);
    return { avg_evaluation_received: avgEvalsReceivedResult.rows[0] };
  }
}
</textarea><pre id="annotations" style="display:none">[]</pre></div>
    <p class="footer-text">TypeScript Coverage Report generated by <a href="https://github.com/plantain-00/type-coverage">type-coverage</a> and <a href="https://github.com/alexcanessa/typescript-coverage-report">typescript-coverage-report</a> at Thu, 04 Jan 2024 18:32:37 GMT</p>
    </body>
  </html>
  